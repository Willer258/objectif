<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Données JSON depuis Google Sheets</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>

    <div id="bg-wrap" style="position: fixed; top:0 ; bottom:0; left:0 ; right:0 ; opacity:0.3">
      <svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice">
      <defs>
      <radialGradient id="Gradient1" cx="50%" cy="50%" fx="0.441602%" fy="50%" r=".5"><animate attributeName="fx" dur="34s" values="0%;3%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(255, 0, 255, 1)"></stop><stop offset="100%" stop-color="rgba(255, 0, 255, 0)"></stop></radialGradient>
      <radialGradient id="Gradient2" cx="50%" cy="50%" fx="2.68147%" fy="50%" r=".5"><animate attributeName="fx" dur="23.5s" values="0%;3%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(255, 255, 0, 1)"></stop><stop offset="100%" stop-color="rgba(255, 255, 0, 0)"></stop></radialGradient>
      <radialGradient id="Gradient3" cx="50%" cy="50%" fx="0.836536%" fy="50%" r=".5"><animate attributeName="fx" dur="21.5s" values="0%;3%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(0, 255, 255, 1)"></stop><stop offset="100%" stop-color="rgba(0, 255, 255, 0)"></stop></radialGradient>
      <radialGradient id="Gradient4" cx="50%" cy="50%" fx="4.56417%" fy="50%" r=".5"><animate attributeName="fx" dur="23s" values="0%;5%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(0, 255, 0, 1)"></stop><stop offset="100%" stop-color="rgba(0, 255, 0, 0)"></stop></radialGradient>
      <radialGradient id="Gradient5" cx="50%" cy="50%" fx="2.65405%" fy="50%" r=".5"><animate attributeName="fx" dur="24.5s" values="0%;5%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(0,0,255, 1)"></stop><stop offset="100%" stop-color="rgba(0,0,255, 0)"></stop></radialGradient>
      <radialGradient id="Gradient6" cx="50%" cy="50%" fx="0.981338%" fy="50%" r=".5"><animate attributeName="fx" dur="25.5s" values="0%;5%;0%" repeatCount="indefinite"></animate><stop offset="0%" stop-color="rgba(255,0,0, 1)"></stop><stop offset="100%" stop-color="rgba(255,0,0, 0)"></stop></radialGradient>
      </defs>
      <!--<rect x="0" y="0" width="100%" height="100%" fill="url(#Gradient4)">
      <animate attributeName="x" dur="20s" values="25%;0%;25%" repeatCount="indefinite" />
      <animate attributeName="y" dur="21s" values="0%;25%;0%" repeatCount="indefinite" />
      <animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="17s" repeatCount="indefinite"/>
      </rect>
      <rect x="0" y="0" width="100%" height="100%" fill="url(#Gradient5)">
      <animate attributeName="x" dur="23s" values="0%;-25%;0%" repeatCount="indefinite" />
      <animate attributeName="y" dur="24s" values="25%;-25%;25%" repeatCount="indefinite" />
      <animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="18s" repeatCount="indefinite"/>
      </rect>
      <rect x="0" y="0" width="100%" height="100%" fill="url(#Gradient6)">
      <animate attributeName="x" dur="25s" values="-25%;0%;-25%" repeatCount="indefinite" />
      <animate attributeName="y" dur="26s" values="0%;-25%;0%" repeatCount="indefinite" />
      <animateTransform attributeName="transform" type="rotate" from="360 50 50" to="0 50 50" dur="19s" repeatCount="indefinite"/>
      </rect>-->
      <rect x="13.744%" y="1.18473%" width="100%" height="100%" fill="url(#Gradient1)" transform="rotate(334.41 50 50)"><animate attributeName="x" dur="20s" values="25%;0%;25%" repeatCount="indefinite"></animate><animate attributeName="y" dur="21s" values="0%;25%;0%" repeatCount="indefinite"></animate><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="7s" repeatCount="indefinite"></animateTransform></rect>
      <rect x="-2.17916%" y="35.4267%" width="100%" height="100%" fill="url(#Gradient2)" transform="rotate(255.072 50 50)"><animate attributeName="x" dur="23s" values="-25%;0%;-25%" repeatCount="indefinite"></animate><animate attributeName="y" dur="24s" values="0%;50%;0%" repeatCount="indefinite"></animate><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="12s" repeatCount="indefinite"></animateTransform>
      </rect>
      <rect x="9.00483%" y="14.5733%" width="100%" height="100%" fill="url(#Gradient3)" transform="rotate(139.903 50 50)"><animate attributeName="x" dur="25s" values="0%;25%;0%" repeatCount="indefinite"></animate><animate attributeName="y" dur="12s" values="0%;25%;0%" repeatCount="indefinite"></animate><animateTransform attributeName="transform" type="rotate" from="360 50 50" to="0 50 50" dur="9s" repeatCount="indefinite"></animateTransform>
      </rect>
      </svg>
    </div>

    <div>

      <h1 style="-top: 5rem;">
        L'ARGENT APPELLE L'ARGENT!!!
      </h1>
  
     
  
      <h1 style="position: absolute; top:10% ; left:0% ; right:0" id="countdown"> </h1>
     
      <div
        style="
          display: flex;
          align-items: center;
          justify-content: space-around;
          padding: 3rem;
          min-height: 100vh;
        "
      >
  
        <div id="wafa" style="display: flex; flex-direction: column; align-items: center">
          <h1><span id="caWAFA">0</span> / 200,000,000 FCFA</h1>
          <div class="container">
            <img  class="beaker" src="./chartwafa.svg" alt="">
             <div class="water_wave"></div>
          </div>
  
          <h1>Defis interne</h1>
        </div>

        
  
        <div id="wiassur" style="display: flex; flex-direction: column; align-items: center">
          <h1><span id="caWiASSUR">0</span> / 2,214,588,154 FCFA</h1>
          <div class="container">            
            <img  class="beaker" src="./chartglobal.svg" alt="">
            <div  class="water_wave2"></div>
          </div>
  
          <h1>Defis interne</h1>
        </div>
      </div>


    </div>


    <script>
      const apiUrl =
        "https://script.google.com/macros/s/AKfycbzRy4KzJ6AvL8mnOcUi9_qbPACSG-XjS-upBAWOfB-I0wZNsP7ul_rnAj08b7_zGa2A2A/exec"; // Remplace par l'URL de ton application Web

      const dynamicStyleSheet = document.createElement("style");
      document.head.appendChild(dynamicStyleSheet);

      // Fonction pour remplir les données et les niveaux de progression
      function remplirProgression(data) {
      
     
        const ObjectifWafa = 200000000;
        const ObjectifWiassur = 2214588154;
        // Calcule les hauteurs en pourcentage
        const pourcentageWafa = (data.totalWafa * 100) / ObjectifWafa;
        const pourcentageWiassur = ((data.totalWiassur * 100) / ObjectifWiassur) ;

        
        console.log(pourcentageWafa,'wafa');
        console.log(pourcentageWiassur,'wiassur');

        createDynamicKeyframes("dynamicWave1", pourcentageWafa +30);
        createDynamicKeyframes("dynamicWave2", pourcentageWiassur -7);

        // Mise à jour des montants dans les éléments HTML
        document.getElementById(
          "caWAFA"
        ).textContent = `${data.totalWafa.toLocaleString()} FCFA`;
        document.getElementById(
          "caWiASSUR"
        ).textContent = `${data.totalWiassur.toLocaleString()} FCFA`;

        document
          .querySelector(".water_wave")
          .style.setProperty("--top-wafa", `${100 - pourcentageWafa}%`);
        document
          .querySelector(".water_wave2")
          .style.setProperty("--top-wiassur", `${100 - pourcentageWiassur}%`);
      }

      function createDynamicKeyframes(id, pourcentageTop) {
        const keyframes = `
        @keyframes ${id} {
          0% { transform: translate(-50%,50%) rotate(0deg); top: ${
            pourcentageTop
          }% }
          50% { top: ${pourcentageTop}% }
          100% { transform: translate(-50%,50%) rotate(360deg); top: ${
            pourcentageTop 
          }% }
        }`;

        console.log(keyframes,'oo');
        // Ajoute l'animation aux styles de la page
        dynamicStyleSheet.sheet.insertRule(
          keyframes,
          dynamicStyleSheet.sheet.cssRules.length
        );
      }



function updateCountdown() {
  const now = new Date();
  const newYear = new Date(now.getFullYear() + 1, 0, 1);
  const timeDifference = newYear - now;

  const days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
  const hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));
  const seconds = Math.floor((timeDifference % (1000 * 60)) / 1000);

  document.getElementById('countdown').innerHTML = 
      ` ${days} jours, ${hours} heures, ${minutes} minutes, ${seconds} secondes avant la fin de l'année !!!`;

  if (timeDifference < 0) {
      document.getElementById('countdown').innerHTML = "Bonne année !";
  }
}

setInterval(updateCountdown, 1000);

function maFonction() {
  console.log("La fonction s'exécute !");
  
fetch('https://script.google.com/macros/s/AKfycbzRy4KzJ6AvL8mnOcUi9_qbPACSG-XjS-upBAWOfB-I0wZNsP7ul_rnAj08b7_zGa2A2A/exec')
.then(response => {
  if (!response.ok) {
    throw new Error('Erreur dans la réponse du réseau');
  }
  return response.json(); // Convertir la réponse en JSON
})
.then(data => {
  console.log('Données reçues :', data); // Afficher les données dans la console
  if (data && data[0]) {
    remplirProgression(data[0]); // Appelle avec les données API
  }
})
.catch(error => {
  console.error('Il y a eu un problème avec la requête fetch :', error);
});


}

function verifierEtExecuter() {
  const maintenant = new Date();
  const heure = maintenant.getHours();
  const minutes = maintenant.getMinutes();
  
  // Vérifie s'il est exactement 8h00 ou 18h00
  if ((heure === 8 || heure === 18) && minutes === 0) {
      maFonction();
  }
}

setInterval(verifierEtExecuter, 60000);

maFonction()

window.onload = function() {
  const wafaDiv = document.getElementById('wafa');
  const wiassurDiv = document.getElementById('wiassur');

  // Masquer WiASSUR au départ
  wiassurDiv.classList.add('hidden');

  // Fonction pour afficher Wafa, puis WiASSUR
  function showWafa() {
      wafaDiv.classList.remove('hidden', 'fade-out');
      wafaDiv.classList.add('fade-in');

      setTimeout(() => {
          wafaDiv.classList.add('fade-out');
          setTimeout(() => {
              wafaDiv.classList.add('hidden'); // Cache Wafa après fade-out
              showWiassur(); // Appel à la fonction pour afficher WiASSUR
          }, 1000); // Durée de l'animation de disparition
      }, 15000); // Afficher Wafa pendant 15 secondes
  }

  function showWiassur() {
      wiassurDiv.classList.remove('hidden', 'fade-out');
      wiassurDiv.classList.add('fade-in');

      setTimeout(() => {
          wiassurDiv.classList.add('fade-out');
          setTimeout(() => {
              wiassurDiv.classList.add('hidden'); // Cache WiASSUR après fade-out
              showWafa(); // Appel à la fonction pour afficher Wafa
          }, 1000); // Durée de l'animation de disparition
      }, 30000); // Afficher WiASSUR pendant 30 secondes
  }

  // Démarre le cycle d'animation
  showWafa(); // Commencer avec Wafa
};
    </script>
  </body>
</html>
